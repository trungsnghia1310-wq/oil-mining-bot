<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>ƒê·∫ø Ch·∫ø D·∫ßu ƒêen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    .task-card {
  background: #0f162a;
  border-radius: 12px;
  padding: 14px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 14px;
  border: 1px solid rgba(255,255,255,0.08);
}

.task-info h3 {
  font-size: 1rem;
  margin: 0;
  color: #fff;
}

.task-info p {
  font-size: 0.8rem;
  opacity: 0.8;
  margin: 4px 0;
}

.task-reward {
  color: #ffe198;
  font-size: 0.85rem;
  margin-top: 6px !important;
}

.task-btn {
  background: #4ade80;
  border-radius: 8px;
  padding: 8px 14px;
  border: none;
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
  color: #000;
}
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1f2933, #020617);
      color: #f9fafb;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .app {
      width: 100%;
      max-width: 480px;
      min-height: 100vh;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      background: transparent;
    }

    header {
      padding: 16px 16px 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    header h1 {
      font-size: 1.05rem;
    }
    header h1 span.logo {
      font-size: 1.35rem;
      margin-right: 6px;
    }
    .user-info {
      text-align: right;
      font-size: 0.7rem;
      opacity: 0.9;
    }

    main {
      flex: 1;
      padding: 0 16px 80px;
      display: flex;
      flex-direction: column;
    }

    .card {
      background: radial-gradient(circle at top, #111827, #020617);
      border-radius: 18px;
      padding: 16px 16px 18px;
      box-shadow:
        0 18px 40px rgba(0,0,0,0.7),
        0 0 0 1px rgba(148,163,184,0.1);
      border: 1px solid rgba(148,163,184,0.18);
    }

    .card + .card {
      margin-top: 14px;
    }

    .section-title {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: .08em;
      color: #9ca3af;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .section-title span.dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #f97316;
      box-shadow: 0 0 8px rgba(249,115,22,0.9);
    }

    .rig-box {
      margin-top: 6px;
      padding: 16px 12px 18px;
      border-radius: 16px;
      background: radial-gradient(circle at top, #020617, #020617);
      border: 1px solid rgba(148,163,184,0.25);
      position: relative;
      overflow: hidden;
    }
    .rig-image {
      width: 110px;
      height: 110px;
      margin: 0 auto 8px;
      border-radius: 18px;
      background: radial-gradient(circle at top, #020617, #020617);
      border: 1px solid rgba(148,163,184,0.35);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow:
        0 14px 35px rgba(15,23,42,0.9),
        0 0 0 1px rgba(15,23,42,0.8),
        0 0 40px rgba(59,130,246,0.15);
    }
    .rig-image span {
      font-size: 2rem;
    }
    .rig-info-row {
      display: flex;
      justify-content: space-between;
      font-size: 0.7rem;
      margin-top: 6px;
      color: #e5e7eb;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(156,163,175,0.6);
      font-size: 0.7rem;
    }
    .pill.gold {
      border-color: #fbbf24;
      background: radial-gradient(circle at top, #1f2937, #020617);
      color: #fef3c7;
      box-shadow: 0 0 14px rgba(245,158,11,0.4);
    }
    .pill span.icon {
      font-size: 0.8rem;
    }

    .rig-stats {
      margin-top: 10px;
      font-size: 0.72rem;
      color: #e5e7eb;
      line-height: 1.4;
    }

    .btn-primary {
      width: 100%;
      margin-top: 14px;
      padding: 11px 0;
      border-radius: 999px;
      border: none;
      font-size: 0.85rem;
      font-weight: 600;
      color: #111827;
      background: radial-gradient(circle at top, #fbbf24, #f97316);
      box-shadow:
        0 12px 24px rgba(249,115,22,0.7),
        0 0 0 1px rgba(251,191,36,0.8);
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    .btn-primary:active {
      transform: translateY(1px);
      box-shadow:
        0 6px 14px rgba(249,115,22,0.6),
        0 0 0 1px rgba(251,191,36,0.8);
    }
    .btn-secondary {
      padding: 7px 18px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.7);
      background: rgba(15,23,42,0.85);
      color: #e5e7eb;
      font-size: 0.75rem;
      cursor: pointer;
    }

    .cooldown-row {
      margin-top: 10px;
      font-size: 0.72rem;
      padding: 7px 10px;
      border-radius: 10px;
      background: rgba(15,23,42,0.8);
      border: 1px dashed rgba(248,113,113,0.7);
      color: #fecaca;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .cooldown-row span.icon {
      font-size: 0.8rem;
    }

    .story {
      font-size: 0.72rem;
      line-height: 1.55;
      color: #e5e7eb;
    }

    .wallet-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 6px;
      font-size: 0.8rem;
    }

    .input-row {
      margin-top: 8px;
    }
    .input-row label {
      font-size: 0.72rem;
      color: #9ca3af;
      display: block;
      margin-bottom: 3px;
    }
    .input-row input {
      width: 100%;
      padding: 7px 9px;
      border-radius: 10px;
      border: 1px solid rgba(55,65,81,0.9);
      background: rgba(15,23,42,0.95);
      color: #f9fafb;
      font-size: 0.78rem;
    }
    .input-hint {
      font-size: 0.68rem;
      color: #9ca3af;
      margin-top: 4px;
    }

    .btn-small {
      margin-top: 8px;
      padding: 7px 12px;
      border-radius: 999px;
      border: none;
      font-size: 0.75rem;
      font-weight: 500;
      color: #111827;
      background: radial-gradient(circle at top, #4ade80, #16a34a);
      box-shadow: 0 10px 18px rgba(22,163,74,0.6);
      cursor: pointer;
    }
    .btn-small.secondary {
      background: rgba(15,23,42,0.9);
      color: #e5e7eb;
      border: 1px solid rgba(156,163,175,0.8);
      box-shadow: none;
    }

    .task-card {
      background: rgba(15,23,42,0.9);
      border-radius: 14px;
      padding: 10px 11px;
      border: 1px solid rgba(31,41,55,0.95);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }
    .task-card + .task-card {
      margin-top: 8px;
    }
    .task-info {
      font-size: 0.75rem;
    }
    .task-info h3 {
      font-size: 0.8rem;
      margin-bottom: 2px;
    }
    .task-info p {
      font-size: 0.72rem;
      color: #d1d5db;
      line-height: 1.4;
    }
    .task-btn {
      padding: 7px 13px;
      border-radius: 999px;
      border: none;
      font-size: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
      background: radial-gradient(circle at top, #4ade80, #16a34a);
      color: #111827;
      box-shadow: 0 10px 18px rgba(34,197,94,0.7);
    }

    .bottom-nav {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      padding: 10px 10px 14px;
      background: linear-gradient(to top, rgba(0,0,0,0.95), rgba(0,0,0,0.7), transparent);
      display: flex;
      justify-content: center;
      pointer-events: none;
    }
    .bottom-nav-inner {
      pointer-events: auto;
      background: rgba(15,23,42,0.96);
      border-radius: 999px;
      padding: 6px 6px;
      display: flex;
      gap: 2px;
      box-shadow: 0 16px 40px rgba(0,0,0,0.8);
      border: 1px solid rgba(30,64,175,0.8);
    }
    .nav-btn {
      flex: 1;
      border-radius: 999px;
      padding: 6px 8px;
      font-size: 0.65rem;
      border: none;
      background: transparent;
      color: #9ca3af;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      cursor: pointer;
    }
    .nav-btn span.icon {
      font-size: 0.85rem;
    }
    .nav-btn.active {
      background: radial-gradient(circle at top, #1d4ed8, #0f172a);
      color: #e5e7eb;
      box-shadow: 0 10px 18px rgba(37,99,235,0.8);
    }

    .screen {
      display: none;
      flex-direction: column;
      gap: 12px;
    }
    .screen.active {
      display: flex;
    }

    .tag {
      font-size: 0.65rem;
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(156,163,175,0.8);
      color: #e5e7eb;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .tag.gold {
      border-color: #fbbf24;
      color: #fef3c7;
    }

    .muted {
      color: #9ca3af;
    }

    .divider {
      width: 100%;
      height: 1px;
      margin: 10px 0;
      background: linear-gradient(to right, transparent, rgba(55,65,81,0.9), transparent);
    }

    .note {
      margin-top: 6px;
      font-size: 0.7rem;
      color: #9ca3af;
      line-height: 1.4;
    }

    .ref-link-row {
      display: flex;
      gap: 6px;
      margin-top: 6px;
    }
    .ref-link-row input {
      flex: 1;
    }
    .btn-copy {
      padding: 7px 10px;
      border-radius: 10px;
      border: 1px solid rgba(156,163,175,0.9);
      background: rgba(15,23,42,0.9);
      color: #e5e7eb;
      font-size: 0.72rem;
      cursor: pointer;
      white-space: nowrap;
    }

    .ref-stats-row {
      margin-top: 8px;
      display: flex;
      gap: 6px;
      font-size: 0.7rem;
    }
    .ref-stats-row > div {
      flex: 1;
      padding: 6px 7px;
      border-radius: 10px;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(31,41,55,0.9);
    }

    .withdraw-history {
      margin-top: 8px;
      font-size: 0.7rem;
      max-height: 110px;
      overflow-y: auto;
    }
    .withdraw-history div {
      padding: 4px 0;
      border-bottom: 1px dashed rgba(55,65,81,0.9);
    }

    /* Quy ƒë·ªïi */
    .convert-box {
      margin-top: 10px;
      display: flex;
      align-items: flex-end;
      gap: 8px;
    }
    .convert-col {
      flex: 1;
    }
    .convert-col label {
      font-size: 0.72rem;
      color: #9ca3af;
      display: block;
      margin-bottom: 3px;
    }
    .convert-col input {
      width: 100%;
      padding: 7px 9px;
      border-radius: 10px;
      border: 1px solid rgba(55,65,81,0.9);
      background: rgba(15,23,42,0.95);
      color: #f9fafb;
      font-size: 0.78rem;
    }
    .convert-swap {
      width: 36px;
      height: 36px;
      border-radius: 999px;
      border: 1px solid rgba(156,163,175,0.9);
      background: rgba(15,23,42,0.95);
      color: #e5e7eb;
      font-size: 1.1rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .convert-note {
      margin-top: 8px;
      font-size: 0.7rem;
      color: #9ca3af;
      line-height: 1.4;
    }
    .big-button {
      width: 100%;
      padding: 9px 0;
      border-radius: 999px;
      border: none;
      font-size: 0.8rem;
      font-weight: 600;
      color: #111827;
      background: radial-gradient(circle at top, #22c55e, #16a34a);
      box-shadow: 0 10px 20px rgba(34,197,94,0.7);
      cursor: pointer;
    }

  </style>
</head>
<body>
<div class="app">
  <header>
    <h1><span class="logo">üõ¢</span>ƒê·∫ø Ch·∫ø D·∫ßu ƒêen</h1>
    <div class="user-info">
      <div id="user-name">@user</div>
      <div id="user-id" style="opacity:.7;">ID: 0</div>
    </div>
  </header>

  <main>
    <!-- HOME -->
    <section class="screen active" id="screen-home">
      <div class="card">
        <div class="section-title">
          <span class="dot"></span>
          <span>Tr·∫°ng th√°i m·ªè d·∫ßu</span>
        </div>

        <div class="rig-box">
<div class="rig-image">
    <img id="rig-image" src="static/image/rig_level1.png" alt="rig" style="width:100%; height:100%; object-fit:contain;" />
</div>

          <div style="text-align:center; font-size:0.8rem; margin-top:4px;">
            Gi√†n khoan Lv.<span id="rig-level-label">1</span>
          </div>

          <div class="rig-info-row" style="margin-top:10px;">
            <span class="pill gold">
              <span class="icon">‚öôÔ∏è</span>
              <span>Gi√†n khoan: <strong id="rig-level-pill">Lv.1</strong></span>
            </span>
            <span class="pill">
              <span class="icon">ü™ô</span>
              <span>Xu: <strong id="xu-pill">0</strong></span>
            </span>
          </div>

          <div class="rig-info-row">
            <span class="pill">
              <span class="icon">üõ¢</span>
              <span>D·∫ßu: <strong id="oil-pill">0</strong></span>
            </span>
            <span class="pill">
              <span class="icon">‚è±</span>
              <span>Chu k·ª≥: 5 ph√∫t</span>
            </span>
          </div>

          <div class="rig-stats">
            Gi√†n khoan hi·ªán t·∫°i: <strong>Lv.<span id="rig-level-text">1</span></strong><br />
            D·∫ßu nh·∫≠n m·ªói chu k·ª≥: <strong id="rig-yield-text">0 D·∫ßu</strong><br />
            Chi ph√≠ n√¢ng c·∫•p: <strong id="rig-upgrade-cost-text">0 D·∫ßu</strong>
          </div>

          <div class="wallet-row" style="margin-top:10px;">
            <button id="btn-upgrade" class="btn-secondary">N√¢ng c·∫•p</button>
            <span class="tag gold">
              10 Xu = 1.000ƒë
            </span>
          </div>

          <button id="btn-mine" class="btn-primary">‚õè Khai th√°c d·∫ßu</button>

          <div id="cooldown-row" class="cooldown-row" style="display:none;">
            <span class="icon">üßØ</span>
            <span id="cooldown-text">Gi√†n khoan ƒëang cooldown...</span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="section-title">
          <span class="dot"></span>
          <span>C·ªët truy·ªán</span>
        </div>
        <p class="story">
          B·∫°n l√† m·ªôt nh√† ƒë·∫ßu t∆∞ m·ªõi, b·∫Øt ƒë·∫ßu t·ª´ m·ªôt m·ªè d·∫ßu nh·ªè gi·ªØa sa m·∫°c.
          M·ªói 5 ph√∫t, gi√†n khoan c·ªßa b·∫°n c√≥ th·ªÉ ho·∫°t ƒë·ªông ƒë·ªÉ h√∫t l√™n nh·ªØng th√πng d·∫ßu ƒë·∫ßu ti√™n.
          D√πng d·∫ßu ƒë·ªÉ n√¢ng c·∫•p m√°y, l√†m nhi·ªám v·ª• ƒë·ªÉ ki·∫øm Xu, r·ªìi d·∫ßn d·∫ßn x√¢y d·ª±ng ƒë·∫ø ch·∫ø d·∫ßu m·ªè c·ªßa ri√™ng m√¨nh.
        </p>
      </div>
    </section>

<!-- TASKS -->
<section class="screen" id="screen-tasks">

  <!-- ===== OFFERWALL ===== -->
  <div class="task-card">
    <div class="task-info">
      <h3>Nhi·ªám v·ª• kh·∫£o s√°t nhanh</h3>
      <p>Th·ª±c hi·ªán kh·∫£o s√°t 5‚Äì15 ph√∫t.</p>
      <p class="task-reward">üéÅ 50‚Äì500 Xu</p>
    </div>
    <button class="task-btn" onclick="openOfferwall('/offer/ayet')">L√†m ngay</button>
  </div>

  <div class="task-card">
    <div class="task-info">
      <h3>Nhi·ªám v·ª• ·ª©ng d·ª•ng</h3>
      <p>T·∫£i app & ho√†n th√†nh y√™u c·∫ßu.</p>
      <p class="task-reward">üéÅ 50‚Äì800 Xu</p>
    </div>
    <button class="task-btn" onclick="openOfferwall('/offer/bitlabs')">L√†m ngay</button>
  </div>

  <div class="task-card">
    <div class="task-info">
      <h3>Nhi·ªám v·ª• ch∆°i game</h3>
      <p>Ch∆°i game ƒë·∫°t c·∫•p ƒë·ªô t·ªëi thi·ªÉu.</p>
      <p class="task-reward">üéÅ 100‚Äì1.500 Xu</p>
    </div>
    <button class="task-btn" onclick="openOfferwall('/offer/adgem')">L√†m ngay</button>
  </div>

  <div class="task-card">
    <div class="task-info">
      <h3>Nhi·ªám v·ª• qu·ªëc t·∫ø</h3>
      <p>Kh·∫£o s√°t/app qu·ªëc t·∫ø ‚Äì thu nh·∫≠p cao.</p>
      <p class="task-reward">üéÅ 150‚Äì3.000 Xu</p>
    </div>
    <button class="task-btn" onclick="openOfferwall('/offer/cpx')">L√†m ngay</button>
  </div>

  <!-- ===== BONUS TASKS ===== -->
  <div class="card" style="margin-top:14px;">
    <div class="section-title">
      <span class="dot"></span><span>Nhi·ªám v·ª• Bonus</span>
    </div>

    <!-- ONUS -->
    <div class="task-card" style="flex-direction:column; align-items:stretch;">
      <div class="task-info">
        <h3>ONUS ‚Äì Nhi·ªám v·ª• ng∆∞·ªùi m·ªõi</h3>
        <p>ƒêƒÉng k√Ω + ho√†n th√†nh nv ng∆∞·ªùi m·ªõi.</p>
        <p class="task-reward">üéÅ Th∆∞·ªüng: 100 Xu</p>
      </div>

      <button class="task-btn" onclick="openOfferwall('https://goonus.io/signup/6277729718282932126?utm_campaign=invite')">M·ªü link ONUS</button>
      <button class="task-btn secondary-btn" onclick="toggleUploadBox('onus')">G·ª≠i ·∫£nh nhi·ªám v·ª•</button>

      <div id="upload-box-onus" style="display:none; flex-direction:column; gap:6px;">
        <input id="file-onus" type="file" accept="image/*">
        <button class="task-btn" onclick="sendTaskImage('onus')">üì§ G·ª≠i ·∫£nh</button>
      </div>
    </div>

    <!-- ATX -->
    <div class="task-card" style="flex-direction:column; align-items:stretch;">
      <div class="task-info">
        <h3>ATX ‚Äì Nhi·ªám v·ª• ng∆∞·ªùi m·ªõi</h3>
        <p>ƒêƒÉng k√Ω + ho√†n th√†nh nv ng∆∞·ªùi m·ªõi.</p>
        <p class="task-reward">üéÅ Th∆∞·ªüng: 200 Xu</p>
      </div>

        <button class="task-btn" onclick="openOfferwall('https://atxs.io/r/54919506')">M·ªü link ATX</button>
        <button class="task-btn secondary-btn" onclick="toggleUploadBox('atx')">G·ª≠i ·∫£nh nhi·ªám v·ª•</button>

      <div id="upload-box-atx" style="display:none; flex-direction:column; gap:6px;">
        <input id="file-atx" type="file" accept="image/*">
        <button class="task-btn" onclick="sendTaskImage('atx')">üì§ G·ª≠i ·∫£nh</button>
      </div>
    </div>

  </div>
</section>

    <!-- CONVERT -->
    <section class="screen" id="screen-convert">
      <div class="card">
        <div class="section-title">
          <span class="dot"></span>
          <span>Quy ƒë·ªïi D·∫ßu ‚Üî Xu</span>
        </div>
        <p style="font-size:0.8rem; opacity:0.9;">
          T·ª∑ l·ªá: <strong>1.000 D·∫ßu = 1 Xu</strong>, ph√≠ giao d·ªãch <strong>1%</strong>.
        </p>

        <div class="wallet-row" style="margin-top:8px;">
          <span>üõ¢ D·∫ßu hi·ªán c√≥:</span>
          <strong id="convert-oil">0</strong>
        </div>
        <div class="wallet-row">
          <span>üí∞ Xu hi·ªán c√≥:</span>
          <strong id="convert-xu">0 Xu</strong>
        </div>

        <div class="convert-box">
          <div class="convert-col">
            <label id="convert-from-label">ƒê·ªïi t·ª´ D·∫ßu</label>
            <input id="convert-from" type="number" min="0" step="1" placeholder="Nh·∫≠p s·ªë D·∫ßu..." />
          </div>

          <button class="convert-swap" type="button" onclick="swapConvertDirection()">‚áÑ</button>

          <div class="convert-col">
            <label id="convert-to-label">Nh·∫≠n v·ªÅ (Xu, sau ph√≠)</label>
            <input id="convert-to" type="text" readonly placeholder="S·ªë nh·∫≠n ƒë∆∞·ª£c..." />
          </div>
        </div>

        <p class="convert-note">
          ‚Ä¢ Nh·∫≠p s·ªë l∆∞·ª£ng ·ªü √¥ b√™n tr√°i, √¥ b√™n ph·∫£i s·∫Ω t·ª± t√≠nh sau khi tr·ª´ 1% ph√≠.<br>
          ‚Ä¢ ·∫§n n√∫t ‚áÑ ƒë·ªÉ ƒë·∫£o chi·ªÅu D·∫ßu ‚Üî Xu.<br>
          ‚Ä¢ ·∫§n ‚ÄúX√°c nh·∫≠n quy ƒë·ªïi‚Äù ƒë·ªÉ √°p d·ª•ng v√†o v√≠ demo.
        </p>

        <button class="big-button" style="margin-top:10px;" onclick="commitConvert()">
          ‚úÖ X√°c nh·∫≠n quy ƒë·ªïi
        </button>

        <p id="convert-msg" style="font-size:0.8rem; margin-top:6px; opacity:0.95;"></p>
      </div>
    </section>

    <!-- FRIENDS -->
    <section class="screen" id="screen-friends">
      <div class="card">
        <div class="section-title">
          <span class="dot"></span>
          <span>M·ªùi b·∫°n b√®</span>
        </div>
        <p class="note" style="font-size:0.8rem; opacity:0.9;">
          ‚Ä¢ M·ªôt <strong>b·∫°n b√® h·ª£p l·ªá</strong> l√† t√†i kho·∫£n ch∆°i game (ho·∫∑c l√†m nhi·ªám v·ª•)
          li√™n t·ª•c √≠t nh·∫•t <strong>3 ng√†y</strong> ƒë·ªÉ tr√°nh cheat / bot.<br />
          ‚Ä¢ T·ª´ <strong>ng√†y th·ª© 4</strong> tr·ªü ƒëi, b·∫°n nh·∫≠n th√™m
          <strong>5% ƒëi·ªÉm s·ªë</strong> m√† ng∆∞·ªùi ƒë√≥ farm ƒë∆∞·ª£c (do backend x·ª≠ l√Ω).<br />
          ‚Ä¢ M·ªói b·∫°n b√® h·ª£p l·ªá ho√†n th√†nh ƒë·ªß ƒëi·ªÅu ki·ªán s·∫Ω th∆∞·ªüng th√™m
          <strong>+100 D·∫ßu</strong> cho ng∆∞·ªùi m·ªùi.
        </p>

        <div class="ref-link-row">
          <input id="ref-link" type="text" readonly />
          <button class="btn-copy" type="button" onclick="copyReferralLink()">Copy</button>
        </div>
        <div id="ref-msg" class="input-hint" style="margin-top:4px;"></div>

        <div class="ref-stats-row">
          <div>
            <div class="muted">B·∫°n b√® h·ª£p l·ªá (demo)</div>
            <div><strong id="ref-count">0</strong></div>
          </div>
          <div>
            <div class="muted">T·ªïng th∆∞·ªüng D·∫ßu (demo)</div>
            <div><strong id="ref-oil">0</strong></div>
          </div>
        </div>

        <p class="note" style="margin-top:10px; font-size:0.75rem;">
          ƒê√¢y ch·ªâ l√† m√¥ ph·ªèng giao di·ªán. Vi·ªác ki·ªÉm tra ‚Äúho·∫°t ƒë·ªông 3 ng√†y, √°p d·ª•ng 5% ƒëi·ªÉm ng√†y 4,
          c·ªông 100 D·∫ßu / b·∫°n h·ª£p l·ªá‚Äù s·∫Ω do backend Telegram c·ªßa b·∫°n x·ª≠ l√Ω v√† tr·∫£ d·ªØ li·ªáu v·ªÅ.
        </p>
      </div>
    </section>

    <!-- WALLET -->
    <section class="screen" id="screen-wallet">
      <div class="card">
        <div class="section-title">
          <span class="dot"></span>
          <span>V√≠ & r√∫t ti·ªÅn</span>
        </div>

        <div class="wallet-row">
          <span class="pill gold">
            <span class="icon">üõ¢</span>
            <span>D·∫ßu hi·ªán c√≥: <strong id="wallet-oil">0</strong></span>
          </span>
          <span class="pill">
            <span class="icon">ü™ô</span>
            <span>Xu hi·ªán c√≥: <strong id="wallet-xu">0</strong></span>
          </span>
        </div>
        <div class="wallet-row">
          <span class="pill">
            <span class="icon">üí∞</span>
            <span>Gi√° tr·ªã Xu: <strong id="wallet-xu-vnd">0 VND</strong></span>
          </span>
          <span class="pill">
            <span class="icon">üìà</span>
            <span>10 Xu = 1.000ƒë</span>
          </span>
        </div>

        <div class="divider"></div>

        <div>
          <div class="section-title" style="margin-bottom:4px;">
            <span class="dot"></span>
            <span>R√∫t ti·ªÅn</span>
          </div>
          <p class="note">
            Quy ∆∞·ªõc: <strong>10 Xu = 1.000ƒë</strong>.
            ƒê·ªÅ xu·∫•t min r√∫t: <strong>200 Xu = 20.000ƒë</strong>.
            ·ªû b·∫£n n√†y r√∫t ti·ªÅn ch·ªâ l√† m√¥ ph·ªèng ph√≠a client
            (b·∫°n k·∫øt n·ªëi API r√∫t th·∫≠t ·ªü backend sau).
          </p>

          <div class="input-row">
            <label for="withdraw-xu-input">S·ªë Xu mu·ªën r√∫t</label>
            <input id="withdraw-xu-input" type="number" min="200" step="10" value="200" />
            <div class="input-hint">
              T·ªëi thi·ªÉu 200 Xu, b·ªôi s·ªë c·ªßa 10. S·ªë Xu s·∫Ω b·ªã tr·ª´ kh·ªèi v√≠ v√† l∆∞u v√†o l·ªãch s·ª≠.
            </div>
          </div>
          <button id="btn-withdraw" class="btn-small secondary">G·ª≠i y√™u c·∫ßu r√∫t (demo)</button>

          <div class="withdraw-history" id="withdraw-history"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- NAV -->
  <nav class="bottom-nav">
    <div class="bottom-nav-inner">
      <button class="nav-btn active" data-target="home">
        <span class="icon">üè†</span><span>Trang</span>
      </button>
      <button class="nav-btn" data-target="tasks">
        <span class="icon">üìã</span><span>Nhi·ªám</span>
      </button>
      <button class="nav-btn" data-target="convert">
        <span class="icon">üí±</span><span>ƒê·ªïi</span>
      </button>
      <button class="nav-btn" data-target="friends">
        <span class="icon">üë•</span><span>B·∫°n</span>
      </button>
      <button class="nav-btn" data-target="wallet">
        <span class="icon">üíº</span><span>V√≠</span>
      </button>
    </div>
  </nav>
</div>

<script>
  // ===== CONSTANTS =====
  const LEVEL_REWARDS = [17.5, 35, 52.5, 70, 87.5, 105, 122.5, 140, 157.5, 175];   // D·∫ßu / chu k·ª≥
  const LEVEL_COSTS   = [0, 5000, 12000, 25000, 50000, 100000, 200000, 400000, 800000, 1500000];
  const COOLDOWN_MS   = 5 * 60 * 1000; // 5 ph√∫t
  const OIL_PER_XU    = 1000;          // 1.000 D·∫ßu -> 1 Xu
  const VND_PER_XU    = 100;           // 10 Xu = 1.000ƒë => 1 Xu = 100ƒë

  const state = {
    oil: 0,
    xu: 0,
    rigLevel: 1,
    lastMineAt: 0,
    withdraws: []
  };

  let cooldownTimer = null;
  let convertDirection = "oil-to-xu"; // ho·∫∑c "xu-to-oil"

  // ===== HELPERS =====
  function formatNumber(n) {
    return n.toLocaleString("vi-VN");
  }
  function formatOil(n) {
    return n.toLocaleString("vi-VN", { minimumFractionDigits: 1, maximumFractionDigits: 1 });
  }

  function saveState() {
    try { localStorage.setItem("oil_miner_state", JSON.stringify(state)); } catch (e) {}
  }
  function loadState() {
    try {
      const raw = localStorage.getItem("oil_miner_state");
      if (!raw) return;
      const obj = JSON.parse(raw);
      if (typeof obj.oil === "number") state.oil = obj.oil;
      if (typeof obj.xu === "number") state.xu = obj.xu;
      if (typeof obj.rigLevel === "number") state.rigLevel = obj.rigLevel;
      if (typeof obj.lastMineAt === "number") state.lastMineAt = obj.lastMineAt;
      if (Array.isArray(obj.withdraws)) state.withdraws = obj.withdraws;
    } catch (e) {}
  }

  function getYield() {
    const idx = Math.min(Math.max(state.rigLevel, 1), 10) - 1;
    return LEVEL_REWARDS[idx];
  }
  function getNextUpgradeCost() {
    const next = state.rigLevel + 1;
    if (next > 10) return null;
    return LEVEL_COSTS[next - 1];
  }

  // ===== UI UPDATE =====
  function updateHeaderUser() {
    try {
      const tg = window.Telegram && window.Telegram.WebApp;
      if (!tg) return;
      const u = tg.initDataUnsafe && tg.initDataUnsafe.user;
      if (!u) return;
      const name = u.username ? '@' + u.username : (u.first_name || '');
      document.getElementById("user-name").textContent = name || '@user';
      document.getElementById("user-id").textContent = "ID: " + (u.id || 0);

      const refInput = document.getElementById("ref-link");
      const baseUrl = "https://t.me/your_bot_username"; // s·ª≠a th√†nh t√™n bot th·∫≠t
      refInput.value = baseUrl + "?start=" + (u.id || 0);
    } catch (e) {}
  }

  function updateHomeUI() {
    const level = state.rigLevel;
    const yieldOil = getYield();
    const nextCost = getNextUpgradeCost();

    document.getElementById("rig-level-label").textContent = level;
    document.getElementById("rig-level-pill").textContent  = "Lv." + level;
    document.getElementById("rig-level-text").textContent  = level;
    document.getElementById("rig-yield-text").textContent  = formatOil(yieldOil) + " D·∫ßu";
    document.getElementById("rig-upgrade-cost-text").textContent =
      nextCost ? formatNumber(nextCost) + " D·∫ßu" : "T·ªëi ƒëa Lv.10";
    document.getElementById("oil-pill").textContent = formatOil(state.oil);
    document.getElementById("xu-pill").textContent  = formatNumber(state.xu);

    const btnUpgrade = document.getElementById("btn-upgrade");
    if (!nextCost) {
      btnUpgrade.disabled = true;
      btnUpgrade.textContent = "ƒê√£ max Lv.10";
    } else if (state.oil >= nextCost) {
      btnUpgrade.disabled = false;
      btnUpgrade.textContent = "N√¢ng c·∫•p (" + formatNumber(nextCost) + " D·∫ßu)";
    } else {
      btnUpgrade.disabled = true;
      btnUpgrade.textContent = "Thi·∫øu D·∫ßu (" + formatNumber(nextCost) + ")";
    }
    // C·∫≠p nh·∫≠t h√¨nh ·∫£nh m√°y ƒë√†o
const rigImg = document.getElementById("rig-image");
rigImg.src = `static/image/rig_level${state.rigLevel}.png`;

    updateCooldownUI();
  }

  function updateConvertUI() {
    document.getElementById("convert-oil").textContent = formatOil(state.oil);
    document.getElementById("convert-xu").textContent  = formatNumber(state.xu) + " Xu";

    const fromLabel = document.getElementById("convert-from-label");
    const toLabel   = document.getElementById("convert-to-label");
    const fromInput = document.getElementById("convert-from");

    if (convertDirection === "oil-to-xu") {
      fromLabel.textContent = "ƒê·ªïi t·ª´ D·∫ßu";
      toLabel.textContent   = "Nh·∫≠n v·ªÅ (Xu, sau ph√≠)";
      fromInput.placeholder = "Nh·∫≠p s·ªë D·∫ßu...";
    } else {
      fromLabel.textContent = "ƒê·ªïi t·ª´ Xu";
      toLabel.textContent   = "Nh·∫≠n v·ªÅ (D·∫ßu, sau ph√≠)";
      fromInput.placeholder = "Nh·∫≠p s·ªë Xu...";
    }

    computeConvertPreview();
  }

  function updateFriendsUI() {
    // Demo: d√πng s·ªë l·∫ßn r√∫t l√†m ref cho vui
    const count = state.withdraws.length;
    const bonusOil = count * 100; // gi·∫£ l·∫≠p 100 d·∫ßu / b·∫°n
    document.getElementById("ref-count").textContent = count;
    document.getElementById("ref-oil").textContent   = formatOil(bonusOil);
  }

  function updateWalletUI() {
    document.getElementById("wallet-oil").textContent = formatOil(state.oil);
    document.getElementById("wallet-xu").textContent  = formatNumber(state.xu);
    document.getElementById("wallet-xu-vnd").textContent =
      formatNumber(state.xu * VND_PER_XU) + " VND";

    const histEl = document.getElementById("withdraw-history");
    histEl.innerHTML = "";
    if (!state.withdraws.length) {
      histEl.innerHTML = '<div class="muted">Ch∆∞a c√≥ y√™u c·∫ßu r√∫t n√†o.</div>';
    } else {
      state.withdraws.slice().reverse().forEach(w => {
        const d = new Date(w.time);
        const row = document.createElement("div");
        row.textContent = d.toLocaleString("vi-VN") +
          " ‚Äî " + formatNumber(w.xu) + " Xu (" +
          formatNumber(w.xu * VND_PER_XU) + "ƒë)";
        histEl.appendChild(row);
      });
    }
  }

  function updateUIAll() {
    updateHomeUI();
    updateConvertUI();
    updateFriendsUI();
    updateWalletUI();
  }

  // ===== COOLDOWN =====
  function getCooldownRemaining() {
    if (!state.lastMineAt) return 0;
    const end = state.lastMineAt + COOLDOWN_MS;
    return Math.max(0, end - Date.now());
  }

  function updateCooldownUI() {
    const remain = getCooldownRemaining();
    const cdRow = document.getElementById("cooldown-row");
    const cdText = document.getElementById("cooldown-text");
    const btnMine = document.getElementById("btn-mine");

    if (remain <= 0) {
      cdRow.style.display = "none";
      btnMine.disabled = false;
      btnMine.textContent = "‚õè Khai th√°c d·∫ßu";
      return;
    }
    cdRow.style.display = "flex";
    btnMine.disabled = true;
    const sec = Math.floor(remain / 1000);
    const m = Math.floor(sec / 60);
    const s = sec % 60;
    cdText.textContent =
      `Gi√†n khoan ƒëang cooldown: c√≤n ${m}m ${s}s n·ªØa m·ªõi khai th√°c ti·∫øp ƒë∆∞·ª£c.`;
    btnMine.textContent = "‚è≥ ƒêang cooldown...";
  }

  function startCooldownTimer() {
    if (cooldownTimer) clearInterval(cooldownTimer);
    cooldownTimer = setInterval(updateCooldownUI, 1000);
  }

  // ===== ACTIONS =====
  function handleMine() {
    const remain = getCooldownRemaining();
    if (remain > 0) {
      updateCooldownUI();
      return;
    }
    const yieldOil = getYield();
    state.oil += yieldOil;
    state.lastMineAt = Date.now();
    saveState();
    updateUIAll();
    startCooldownTimer();
    alert("ƒê√£ khai th√°c +" + formatOil(yieldOil) + " D·∫ßu!");
  }

  function handleUpgrade() {
    const nextCost = getNextUpgradeCost();
    if (!nextCost) {
      alert("Gi√†n khoan ƒë√£ ƒë·∫°t Lv.10 t·ªëi ƒëa.");
      return;
    }
    if (state.oil < nextCost) {
      alert("Kh√¥ng ƒë·ªß D·∫ßu ƒë·ªÉ n√¢ng c·∫•p.");
      return;
    }
    if (!confirm("N√¢ng c·∫•p gi√†n khoan l√™n Lv." + (state.rigLevel + 1) +
      " v·ªõi " + formatNumber(nextCost) + " D·∫ßu?")) return;

    state.oil -= nextCost;
    state.rigLevel += 1;
    saveState();
    updateUIAll();
    alert("ƒê√£ n√¢ng c·∫•p l√™n Lv." + state.rigLevel + "!");
  }

  // --- Quy ƒë·ªïi m·ªõi ---
  function computeConvertPreview() {
    const fromVal = Number(document.getElementById("convert-from").value || "0");
    const toInput = document.getElementById("convert-to");

    if (!fromVal) {
      toInput.value = "";
      return;
    }

    let receive;
    if (convertDirection === "oil-to-xu") {
      const oil = Math.min(fromVal, state.oil);
      const rawXu = oil / OIL_PER_XU;
      const fee  = rawXu * 0.01;
      receive = rawXu - fee;
      toInput.value = formatNumber(receive.toFixed(2)) + " Xu";
    } else {
      const xu   = Math.min(fromVal, state.xu);
      const rawOil = xu * OIL_PER_XU;
      const fee    = rawOil * 0.01;
      receive = rawOil - fee;
      toInput.value = formatNumber(Math.floor(receive)) + " D·∫ßu";
    }
  }

  function swapConvertDirection() {
    convertDirection = (convertDirection === "oil-to-xu") ? "xu-to-oil" : "oil-to-xu";
    document.getElementById("convert-from").value = "";
    document.getElementById("convert-to").value   = "";
    document.getElementById("convert-msg").textContent = "";
    updateConvertUI();
  }

  function commitConvert() {
    const msgEl  = document.getElementById("convert-msg");
    msgEl.style.color = "#e5e7eb";
    const fromVal = Number(document.getElementById("convert-from").value || "0");
    if (fromVal <= 0 || !isFinite(fromVal)) {
      msgEl.textContent = "Nh·∫≠p s·ªë h·ª£p l·ªá tr∆∞·ªõc khi quy ƒë·ªïi.";
      return;
    }

    if (convertDirection === "oil-to-xu") {
      if (fromVal > state.oil) {
        msgEl.textContent = "B·∫°n kh√¥ng ƒë·ªß D·∫ßu.";
        msgEl.style.color = "#f97316";
        return;
      }
      const oil = fromVal;
      const rawXu = oil / OIL_PER_XU;
      const fee  = rawXu * 0.01;
      const xuGet = Math.floor((rawXu - fee) * 100) / 100; // 2 ch·ªØ s·ªë

      if (!confirm(`Quy ƒë·ªïi ${formatNumber(oil)} D·∫ßu l·∫•y kho·∫£ng ${formatNumber(xuGet)} Xu (ƒë√£ tr·ª´ ph√≠ 1%)?`)) return;
      state.oil -= oil;
      state.xu  += xuGet;
      msgEl.textContent = `ƒê√£ quy ƒë·ªïi ${formatNumber(oil)} D·∫ßu ‚Üí +${formatNumber(xuGet)} Xu.`;
      msgEl.style.color = "#4ade80";
    } else {
      if (fromVal > state.xu) {
        msgEl.textContent = "B·∫°n kh√¥ng ƒë·ªß Xu.";
        msgEl.style.color = "#f97316";
        return;
      }
      const xu   = fromVal;
      const rawOil = xu * OIL_PER_XU;
      const fee    = rawOil * 0.01;
      const oilGet = Math.floor(rawOil - fee);

      if (!confirm(`Quy ƒë·ªïi ${formatNumber(xu)} Xu l·∫•y kho·∫£ng ${formatNumber(oilGet)} D·∫ßu (ƒë√£ tr·ª´ ph√≠ 1%)?`)) return;
      state.xu  -= xu;
      state.oil += oilGet;
      msgEl.textContent = `ƒê√£ quy ƒë·ªïi ${formatNumber(xu)} Xu ‚Üí +${formatNumber(oilGet)} D·∫ßu.`;
      msgEl.style.color = "#4ade80";
    }

    document.getElementById("convert-from").value = "";
    document.getElementById("convert-to").value   = "";
    saveState();
    updateUIAll();
  }

  function handleWithdraw() {
    const input = document.getElementById("withdraw-xu-input");
    const raw = Number(input.value || "0");
    const xu = Math.floor(raw / 10) * 10;
    if (xu < 200) {
      alert("Min r√∫t demo l√† 200 Xu (20.000ƒë).");
      return;
    }
    if (xu > state.xu) {
      alert("B·∫°n kh√¥ng ƒë·ªß Xu ƒë·ªÉ r√∫t.");
      return;
    }
    if (!confirm(`G·ª≠i y√™u c·∫ßu r√∫t ${formatNumber(xu)} Xu (~${formatNumber(xu * VND_PER_XU)}ƒë)?`)) return;
    state.xu -= xu;
    state.withdraws.push({ time: Date.now(), xu });
    saveState();
    updateUIAll();
    alert("Y√™u c·∫ßu r√∫t (demo) ƒë√£ ƒë∆∞·ª£c l∆∞u. B·∫°n k·∫øt n·ªëi API r√∫t th·∫≠t ·ªü backend sau.");
  }

  function openOfferwall(url) {
    try {
      const tg = window.Telegram && window.Telegram.WebApp;
      if (tg && tg.openLink) {
        tg.openLink(url, { try_instant_view: false });
        return;
      }
    } catch (e) {}
    window.open(url, "_blank");
  }

  function showUploadGuide(source) {
    const taskName = (source === "onus") ? "ONUS" : "ATX";
    const rewardXu = (source === "onus") ? 100 : 200;
    alert(
      "H∆∞·ªõng d·∫´n g·ª≠i ·∫£nh nhi·ªám v·ª• " + taskName + ":\n\n" +
      "1. M·ªü app / web " + taskName + " theo link nhi·ªám v·ª• v√† ho√†n th√†nh Nhi·ªám v·ª• ng∆∞·ªùi m·ªõi.\n" +
      "2. Ch·ª•p ·∫£nh m√†n h√¨nh th·ªÉ hi·ªán b·∫°n ƒë√£ ho√†n th√†nh.\n" +
      "3. Quay l·∫°i c·ª≠a s·ªï chat bot Telegram v√† g·ª≠i ·∫£nh cho admin.\n\n" +
      "Sau khi admin x√°c nh·∫≠n th√†nh c√¥ng, b·∫°n s·∫Ω ƒë∆∞·ª£c c·ªông " + rewardXu + " Xu v√†o game."
    );
  }

  function copyReferralLink() {
    const input = document.getElementById("ref-link");
    const msgEl = document.getElementById("ref-msg");
    if (!input || !msgEl) return;

    try {
      input.select();
      input.setSelectionRange(0, 99999);
      document.execCommand("copy");
      msgEl.textContent = "ƒê√£ copy link m·ªùi v√†o clipboard.";
      msgEl.style.color = "#4ade80";
      setTimeout(() => { msgEl.textContent = ""; }, 2000);
    } catch (e) {
      msgEl.textContent = "Kh√¥ng copy ƒë∆∞·ª£c, h√£y copy th·ªß c√¥ng.";
      msgEl.style.color = "#f97316";
    }
  }

  function setupNav() {
    const buttons = document.querySelectorAll(".nav-btn");
    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        buttons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        const target = btn.dataset.target;
        document.querySelectorAll(".screen").forEach(sc => sc.classList.remove("active"));
        document.getElementById("screen-" + target).classList.add("active");
        // c·∫≠p nh·∫≠t l·∫°i UI khi chuy·ªÉn tab
        updateUIAll();
      });
    });
  }

  // ===== INIT =====
  loadState();
  updateHeaderUser();

  document.getElementById("btn-mine").addEventListener("click", handleMine);
  document.getElementById("btn-upgrade").addEventListener("click", handleUpgrade);
  document.getElementById("btn-withdraw").addEventListener("click", handleWithdraw);
  document.getElementById("convert-from").addEventListener("input", computeConvertPreview);

  setupNav();
  updateUIAll();
  startCooldownTimer();
function toggleUploadBox(type) {
    const box = document.getElementById("upload-box-" + type);
    if (!box) return;

    box.style.display = (box.style.display === "none" || box.style.display === "") 
                        ? "flex" 
                        : "none";
}

// G·ª≠i ·∫£nh ‚Äî b·∫£n front-end (demo)
function sendTaskImage(type) {
    const input = document.getElementById("file-" + type);
    if (!input || !input.files.length) {
        alert("B·∫°n ch∆∞a ch·ªçn ·∫£nh.");
        return;
    }

    const file = input.files[0];

    alert(
        "·∫¢nh ƒë√£ ƒë∆∞·ª£c ch·ªçn th√†nh c√¥ng!\n\n" +
        "B·∫¢N DEMO: ·∫¢nh ch∆∞a g·ª≠i ƒëi ƒë√¢u c·∫£.\n" +
        "‚Üí B·∫°n c·∫ßn x·ª≠ l√Ω g·ª≠i ·∫£nh th·∫≠t ·ªü backend Telegram Bot API."
    );

    // Reset input
    input.value = "";
}
</script>
</body>
</html>